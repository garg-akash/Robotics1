function [r_vec1,r_vec2,th] = Inverse_Rot_r_th(R)

R = sym(R);
c_th = (R(1,1)+R(2,2)+R(3,3)-1)/2;
s_th = 0.5*sqrt((R(1,2)-R(2,1))^2 + (R(1,3)-R(3,1))^2 + (R(2,3)-R(3,2))^2)*[1,-1];
th = atan2(s_th,c_th);
r_vec1 = (1/(2*sin(th(1))))*[(R(3,2)-R(2,3));(R(1,3)-R(3,1));(R(2,1)-R(1,2))];
r_vec2 = (1/(2*sin(th(2))))*[(R(3,2)-R(2,3));(R(1,3)-R(3,1));(R(2,1)-R(1,2))];
